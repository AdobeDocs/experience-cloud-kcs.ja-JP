---
title: Dispatcher バニティー URL
description: 説明
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/20/2021 7:50:47 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 1:44:45 PM
version-number: 1
article-number: KA-17463
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=2c589e02-df31-ec11-b6e5-000d3a5ba97a
exl-id: 8576ab35-d33b-43c4-94a8-d63fceb21a86
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '1112'
ht-degree: 0%

---

# Dispatcher バニティー URL

## 説明


このドキュメントでは、AEMでバニティー URL を扱う方法や、書き換えルールを使用してコンテンツを配信の端に近づける方法を説明します
<br><br><br><br>バニティー URL とは<br><br><br><br><br><br>
意味のあるフォルダー構造に存在するコンテンツがある場合、必ずしも参照しやすい URL に存在するとは限りません。  バニティー URL はショートカットのようなものです。  実際のコンテンツが存在する場所を参照する短い、または一意の URL。

例： <b>/aboutus</b> ～を指さす <b>/content/we-retail/us/en/about-us.html</b>

AEM 作成者には、AEM内のコンテンツの一部にバニティ URL プロパティを設定して公開するオプションがあります。

この機能を使用するには、バニティを許可するように Dispatcher のフィルターを調整する必要があります。  これは、作成者がこれらのバニティーページエントリを設定する必要がある割合で Dispatcher 設定ファイルを調整する場合に不合理になります。

このため、Dispatcher モジュールには、コンテンツツリーにバニティとしてリストされるすべての項目を自動許可する機能があります。


## 解像度

<br><br>仕組み<br><br><br><br><br><br>バニティー URL のオーサリング<br><br><br><br><br><br>
作成者がAEMのページを訪問し、ページのプロパティを訪問して、「バニティ URL」セクションにのエントリを追加します。

ユーザーが変更を保存し、ページをアクティベートすると、バニティーがこのページに割り当てられます。

タッチ操作対応 UI:
![サイトエディター画面でAEMオーサリング UI 用のドロップダウンダイアログメニュー](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image/aem-page-properties-drop-down.png "aem-page-properties-dropdown")![aem ページのプロパティダイアログページ](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image_1434026267/aem-page-properties.png "aem-page-properties")
クラシックコンテンツファインダー：
![AEM siteadmin classic ui サイドキックのページプロパティ](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image_1939359337/aem-page-properties-sidekick.png "aem-page-properties-sidekick")![クラシック UI のページプロパティダイアログボックス](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image_1023003881/aem-page-properties-classic.png "aem-page-properties-classic")
注意：

これは名前空間の問題に対して非常に脆弱であることを理解してください。

バニティエントリはすべてのページに対してグローバルです。これは、後で説明する回避策について計画する必要がある短いコメントの 1 つに過ぎません。


<br><br><br><br> <br><br>リソースの解決/マッピング<br><br><br><br> <br><br>
各バニティエントリは、内部リダイレクトの Sling マップエントリです。

これらのマップは、AEMインスタンスの Felix コンソール ( <b>/system/console/jcrresolver </b>)

バニティエントリによって作成されたマップエントリのスクリーンショットを次に示します。
![リソース解決ルール内のバニティーエントリのコンソールスクリーンショット](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image_228354446/vanity-resource-resolver-entry.png "vanity-resource-resolver-entry")<br><br><br><br> <br><br>
上記の例では、AEMインスタンスに/aboutus にアクセスするように求めると、/content/we-retail/us/en/about-us.htmlに解決されます。
<br><br><br><br> <br><br>Dispatcher の自動許可フィルター<br><br><br><br> <br><br>
安全な状態の Dispatcher は、JCR ツリーのルートなので、Dispatcher のパス/で要求を除外します。

発行者が/content や他の安全なパスなどからのコンテンツのみを許可していることを確認することが重要です。  /system などのパスではなく、

ここでは、rub、バニティ URL は/の基本フォルダーにあります。そのため、安全な状態でパブリッシャーに到達するには、どうすればよいですか？

シンプルな Dispatcher には自動フィルターの許可メカニズムがあり、AEMパッケージをインストールしてから、そのパッケージページを指すように Dispatcher を設定する必要があります。

[https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/granite/vanityurls-components](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/granite/vanityurls-components)

Dispatcher には、そのファームファイルに設定セクションがあります。
<br><br><br><br><br> <br><br><br><br>

| `/vanity_urls {``    ``/url    "/libs/granite/dispatcher/content/vanityUrls.html"``    ``/file   "/tmp/vanity_urls"``    ``/delay  300``}` |
| --- |

<br><br><br><br><br> <br><br>
この設定は、300 秒ごとにフロントするAEMインスタンスからこの URL を取得し、許可する項目のリストを取得するよう Dispatcher に指示します。

応答のキャッシュを/file 引数に格納します。この例では、/tmp/vanity_urls に格納します。

そのため、URI でAEMインスタンスにアクセスすると、そのインスタンスが取得する内容が表示されます。
![/libs/granite/dispatcher/content/vanityUrls.htmlからレンダリングされたコンテンツのスクリーンショット](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/ams-dispatcher-manual/disp-vanity-url/jcr_content/main-pars/image_348723126/vanity-url-component.png "vanity-url-component")<br><br><br><br> <br><br>
文字通り、非常にシンプルなリストです
<br><br><br><br> <br><br>ルールをバニティルールとして書き換える<br><br><br><br> <br><br>
上述のように、AEMに組み込まれているデフォルトのメカニズムの代わりに、書き換えルールを使用することが挙げられるのはなぜですか。

簡単に、名前空間の問題、パフォーマンス、より適切に処理できる高レベルのロジックについて説明します。

バニティエントリの例を見てみましょう */aboutus* 内容は */content/we-retail/us/en/about-us.html* これをおこなうには、Apache の mod_rewrite モジュールを使用します。
<br><br><br><br><br> <br><br><br><br>

| 1 | `RewriteRule /aboutus /content/we-retail/us/en/about-us.html PT,L,NC` |
| --- | --- |

<br><br><br><br><br> <br><br>
このルールは、バニティ/aboutus を探し、PT フラグ (Pass Through) を持つレンダラーから完全なパスを取得します。

また、他のすべてのルール L フラグ (Last) の処理が停止します。つまり、JCR Resolving などの大量のルールリストをトラバースする必要がなくなります。

リクエストをプロキシせずに、aem パブリッシャーがこのメソッドのこれらの 2 つの要素に応答するのを待つことで、パフォーマンスが大幅に向上します。

次に、ここでのケーキのアイシングは NC フラグ（大文字と小文字を区別しない）です。つまり、顧客が/aboutus の代わりに/AboutUs で URI を取り込んだ場合でも、引き続き動作し、正しいページを取得できます。

書き換えルールを作成するには、Dispatcher に設定ファイルを作成します ( 例：/etc/httpd/conf.d/rewrites/examplevanity_rewrite.rules) を参照し、これらのバニティー url を適用する必要があるドメインを処理する.vhost ファイルに含めます。

/etc/httpd/conf.d/enabled_vhosts/we-retail.vhost内のインクルードのコードスニペットの例を次に示します。
<br><br><br><br><br> <br><br><br><br>

| 1<br>  2<br>  3<br>  4<br>  5<br>  6<br>  7<br>  8<br>  9<br>  10<br>  11 | ```VirtualHost` `*:80``    ``ServerName    weretail.com``    ``ServerAlias    www.weretail.com``        ``........ SNIP ........``    ````IfModule` `mod_rewrite.c``        ``ReWriteEngine    on``        ``LogLevel warn rewrite:info``        ``Include /etc/httpd/conf.d/rewrites/examplevanity_rewrite.rules``    ``/``IfModule````        ``........ SNIP ........``/``VirtualHost``` |
| --- | --- |

<br><br><br><br><br> <br><br>メソッドと場所<br><br><br><br> <br><br>
バニティエントリの制御にAEMを使用すると、次の利点があります

- 作成者はその場で作成できます
- コンテンツと共に存在し、コンテンツと共にパッケージ化できます


mod_rewrite を使用してバニティエントリを制御すると、次の利点があります。

- コンテンツの解決を迅速に行う
- エンドユーザーコンテンツリクエストのエッジに近い
- 他の条件でのコンテンツのマッピング方法を制御するための拡張機能とオプションの追加
- 大文字と小文字を区別しない可能性があります


両方の方法を使用しますが、次の場合にどの方法を使用するかに関するアドバイスと条件を示します。

- バニティが一時的で、予定されているトラフィックレベルが低い場合は、組み込み機能AEMを使用します
- バニティーが頻繁に変更されず、頻繁に使用されるステープルエンドポイントの場合は、mod_rewrite ルールを使用します。
- バニティー名前空間の場合 ( 例：/aboutus) は、同じAEMインスタンス上の多数のブランドで再利用し、書き換えルールを使用する必要があります。


注釈:

AEMバニティ機能を使用し、名前空間を避けたい場合は、命名規則を作成できます。  /brand1/aboutus、brand2/aboutus、brand3/aboutus のようにネストされたバニティー URL の使用。
