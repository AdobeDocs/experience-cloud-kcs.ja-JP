---
title: "null 値の処理に関するAEM GraphQLの変更"
description: 説明
solution: Experience Manager as a Cloud Service
product: Experience Manager as a Cloud Service
applies-to: "Experience Manager as a Cloud Service"
keywords: "KCS,Adobe Experience Manager, GraphQL"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Cedric Latimier
article-created-date: "3/29/2023 11:50:20 AM"
article-published-by: Cedric Latimier
article-published-date: "3/29/2023 11:52:15 AM"
version-number: 2
article-number: KA-21792
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3b2b10e0-27ce-ed11-b597-6045bd006a22"
source-git-commit: 87d2439bb68c8003b1fbe094fae7e6c7e83193ec
workflow-type: tm+mt
source-wordcount: '729'
ht-degree: 1%

---

# null 値の処理に関するAEM GraphQLの変更

## 説明 {#description}

<b><u>のGraphQL処理の変更点 <em>null</em> 値</u></b><br><br> <br><br>リリース2023.02.11382では、古いリリースの誤った動作に依存していた場合に、アプリケーションコードで予期しない動作が発生する可能性がある、GraphQLの実装でいくつかの改善がおこなわれました。 
<br>この改善は、AEM GraphQLの実現に役立ちます <b>次の場合、コンテンツを返します： *null* の値は、すべてのフィルター操作で一貫して設定されます。 </b>

## 解決策 {#resolution}

<b><u>CONTAINS_NOT および <em>null</em> 値</u></b><br> <br>1 つ目の変更は、CONTAINS_NOT 演算子を利用したフィルター条件に影響します。 以前のリリースでは、これらの CONTAINS_NOT は、 *null* フィルター条件が適用されたフィールドの値。 これは、EQUALS_NOT や NOT_AT などの類似の演算子とは矛盾します。<br>お使いのクライアントアプリケーションが *null* CONTAINS_NOT を使用した場合にAEMが返す値。<br> <br><b>例:</b>

| <b>フラグメントをフィルター</b> | <b>データ</b> | <b>2023.02.11382より前の結果</b> | <b>2023.02.11382で始まる結果</b> |
| --- | --- | --- | --- |
| myField:{<br>    値：「フラグ」 <br>    _op:CONTAINS_NOT<br>} | <br>    {<br>        myField:null<br>    }, <br>    {<br>        myField:&quot;Some text&quot;<br>    },<br>    {<br>        myField:&quot;テキストフラグメント&quot;<br>    }<br> | <br>    {<br>        myField:&quot;Some text&quot;<br>    }<br> | <br>    {<br>        myField:null<br>    },<br>    {<br>        myField:&quot;Some text&quot;<br>    }<br> |


<b><u>モード ALL_OR_EMPTY/ALL および <em>null</em> 値</u></b>

2023.02.11382で修正された別の問題は、 *null* 複数値フィールドのフィルター条件の値。 適用モード ALL_OR_EMPTY （配列/複数値フィールドの場合）が、 *null* 問題のフィールドの値は、ALL apply メソッドの場合と同じように、実際に機能していました。 同時に、適用モードで複数値フィールドをフィルタリングすると、すべてのフィールドに空のコンテンツを含むフラグメントが含まれますが、含めないでください。これらの適用モードの 1 つを使用するクエリをテストし、2023.02.11382で期待された結果セットが返されない場合は、クエリを変更することをお勧めします。

この問題は、一部のオペレーター (2023.02.11382以前 ) に対してのみ発生していました。
例えば、適用メソッド ALL_OR_EMPTY では EQUALS_NOT が期待どおりに動作するのに対して、CONTAINS は期待したとおりに動作しませんでした。
<b>例：</b>

| <b>フラグメントをフィルター</b> | <b>データ</b> | <b>2023.02.11382より前の結果</b> | <b>2023.02.11382で始まる結果</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    値：&quot;1.3&quot;<br>    _operator:EQUALS_NOT<br>    _apply:すべて<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;, &quot;1.2&quot;, &quot;1.3&quot; <br>  },<br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> |
| myArray:{<br>  _expressions:{<br>    値：「2」<br>    _operator:次を含む<br>    _apply:ALL_OR_EMPTY<br>  }<br>} | <br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> |


<b><u>適用モード INSTANCES、_instances:0 および <em>null</em> 値</u></b>

最後の問題は、 *null* 複数値フィールドのフィルター条件の値。 _instances を使用してモード INSTANCES を適用します。0 は次を含むコンテンツフラグメントと一致しませんでした： *null* 2023.02.11382より前の各フィールドの値。ただし、2023.02.11382から始まります。この配置を使用するクエリをテストし、2023.02.11382で設定された期待される結果が返されない場合は、クエリを変更することをお勧めします。
<b>例：</b>

| <b>フラグメントをフィルター</b> | <b>データ</b> | <b>2023.02.11382より前の結果</b> | <b>2023.02.11382で始まる結果</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    値：「2」<br>    _operator:次を含む<br>    _apply:インスタンス<br>    _instances:0<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;, &quot;1.2&quot;, &quot;1.3&quot; <br>  },<br>  {<br>    myArray:&quot;2.1&quot;, &quot;2.2&quot;, &quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:&quot;1.1&quot;, &quot;1.2&quot;, &quot;1.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;, &quot;1.2&quot;, &quot;1.3&quot; <br>  }<br> |


<b><u>のお客様に影響を与える可能性のある改善点 <em>ft-sites-97</em> 有効</u></b>

次の条件を満たす *ft-sites-97(GraphQLのページネーションと最適化されたフィルタリング )* 機能フラグが有効 *前*&#x200B;リリース2023.02.11382は、2023.02.11382にアップグレードした後、次の動作の変更が 1 つ以上発生する可能性があります。この機能フラグを有効にしていないお客様は、この節の影響を受けません。

<b>*<u>null </u></b><b>*<u>非等価を確認する条件を使用した処理</u></b>

フラグメントフィールド *null* 値は、非等価をチェックしているフィルターと断続的に一致しませんでした

コードでこれらのフラグメントが返されないことに依存している場合は、期待される動作に合わせてコードを調整する必要があります。


| <b>フラグメントをフィルター</b> | <b>データ</b> | <b>中間実装の結果</b> | <b>最終実装からの結果</b> |
| --- | --- | --- | --- |
| myField:{<br>  値：「テキスト」<br>  _op:EQUALS_NOT<br>} | <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;Some text&quot;<br>  },<br>  {<br>    myField:&quot;テキストフラグメント&quot;<br>  }<br> | <br>  {<br>    myField:&quot;Some text&quot;<br>  }<br> | <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;Some text&quot;<br>  }<br> |


<b><u>日時値を持つフィルタ演算子 NOT_AT</u></b>

フィルタ演算子 NOT_AT が、データ/時間値で正しく動作しないことが断続的にありました。 代わりに、AFTER 条件のように機能していました。 
コードで誤った動作が使用されている場合は、フィルター条件を AFTER に切り替える必要があります。

<b><u>配列：インスタンス数 (_instances):0 は正しく機能しません</u></b>

_instances が 0 に設定された INSTANCES（配列/複数値フィールド上）のフィルター条件は、断続的に動作せず、実際にが存在するはずの場所は何も返しませんでした。

この問題の影響を受けるフィルターフラグメントは、次のようになります。doubleArray:{ _expressions:{ 値：0, _operator:より大きい (_A):インスタンス (_instances):0 } }

誤った動作に依存していた場合は、以前と同じ結果を返すようにクエリを書き換える必要があります。


| <b>フラグメントをフィルター</b> | <b>データ</b> | <b>中間実装の結果</b> | <b>最終実装からの結果</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    値：20<br>    _operator:次と等しい<br>    _apply:インスタンス<br>    _instances:0<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:10、20、30 <br>  },<br>  {<br>    myArray:11, 12, 13 <br>  }<br> |  | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:11, 12, 13 <br>  }<br> |

