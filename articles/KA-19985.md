---
title: 「Adobe Experience Manager：予期せず  [!DNL Dispatcher]  キャッシュファイルが更新される」
description: 説明
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Nobuhiro Hashimoto
article-created-date: 6/30/2022 5:05:25 AM
article-published-by: Nobuhiro Hashimoto
article-published-date: 6/30/2022 5:08:03 AM
version-number: 2
article-number: KA-19985
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=b083b13c-32f8-ec11-bb3d-000d3a5b0be0
exl-id: 57f937e5-0e45-4fba-b158-e8870ab1b868
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '235'
ht-degree: 100%

---

# Adobe Experience Manager：予期せず [!DNL Dispatcher] キャッシュファイルが更新される

## 説明


[!DNL Dispatcher] キャッシュファイルが予期しないタイミングや頻度で更新されていることに気づくことがあります。この記事では、そのような状況を分析する方法を説明します。

<b>環境</b>
AEM as a Cloud Service、AEM 6.5


## 解決策


コンテンツを公開する際に、AEM は、キャッシュ無効化リクエスト（`GET /dispatcher/invalidate.cache`）を [!DNL Dispatcher] に送信します。その後、[!DNL Dispatcher] にコンテンツのリクエストが来ると、キャッシュファイルを更新します。

この動作に基づいて、キャッシュ無効化リクエストおよびコンテンツリクエストのログを収集し、パターンを探します。

無効化リクエストのログの例：
<br>[!DNL Dispatcher] - `access_log`


```
127.0.0.1 - - 07/Jun/2022:13:44:35 +0900 "GET /dispatcher/invalidate.cache HTTP/1.1" 200 13 "about:blank" "Jakarta Commons-HttpClient/3.1"
```

<br>[!DNL Dispatcher] - `dispatcher.log`


```
07/Jun/2022:13:44:35 +0900 "GET /dispatcher/invalidate.cache HTTP/1.1" 200 purge publish/- 0ms
```

<br>Publish - `error.log`


```
07.06.2022 13:44:35.750 *INFO* sling-threadpool-f158f7aa-d59d-4d34-9bfa-be84a03a917f-(apache-sling-job-thread-pool)-1-com_day_cq_replication_job_flush(com/day/cq/replication/job/flush) com.day.cq.replication.Agent.flush Sending GET request to http://localhost:80/dispatcher/invalidate.cache
...
07.06.2022 13:44:35.758 *INFO* sling-threadpool-f158f7aa-d59d-4d34-9bfa-be84a03a917f-(apache-sling-job-thread-pool)-1-com_day_cq_replication_job_flush(com/day/cq/replication/job/flush) com.day.cq.replication.Agent.flush Replication (ACTIVATE) of /content/we-retail/us/en/products successful.
```




<b>原因</b>

次に、Dispatcher キャッシュファイルが予期せず更新される典型的な事例を示します。


<u>ケース 1 - 予期せぬコンテンツに対する頻繁なキャッシュの更新</u>

キャッシュファイルは、頻繁に更新されますが、更新された内容は、キャッシュ無効化リクエストの対象にはなりません。

この場合、[!DNL Dispatcher] 設定にある `/statfileslevel` の値が低すぎる可能性があります。`dispatcher.any` で `/statfileslevel` をコメントアウトすると、この値にとって「0」を意味することに注意してください。

`/statfileslevel "0"` でコンテンツを公開すると、パスに関係なく、すべてのキャッシュファイルが無効となります。詳しくは、リファレンスを参照してください。

https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html?lang=ja#invalidating-files-by-folder-level


<u>ケース 2 - 好ましくないクライアントからのキャッシュ無効化リクエスト</u>

[!DNL Dispatcher] 設定に、キャッシュ無効化リクエストに対する適切な制限がない可能性があります。`dispatcher.any` の `/allowedClients` を確認してください。


<u>ケース 3 - キャッシュ無効化リクエストがない</u>

[!DNL Dispatcher] 設定では、時間ベースのキャッシュ無効化を使用できます。この場合、`dispatcher.any` に `/enableTTL "1"` が存在している必要があります。
