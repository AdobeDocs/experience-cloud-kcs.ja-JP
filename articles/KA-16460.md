---
title: 同期AEMインデックスの再インデックスの方法 | AEM, Oak"
description: 説明
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:19:48 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:21:41 PM"
version-number: 2
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3613fb7d-6687-eb11-a812-000d3a593216"
exl-id: 1209609f-84a9-4810-b7c8-1193b09f82d7
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '440'
ht-degree: 0%

---

# 同期AEMインデックスの再インデックスの方法 | AEM, Oak

## 説明


ダウンタイムを発生させずに同期 Oak インデックスを適切に再インデックスする方法を教えてください。


## 解像度


reindex プロパティを true に設定するだけで同期インデックスを再インデックスすると、同期操作が実行され、Oak インスタンスがハングする可能性があります。 この状況を回避するには、インデックスをバックグラウンドスレッドに送信します。  これをおこなうには、次の手順に従います。

<b>手順 1:</b> バックグラウンドスレッドでインデックスを再作成

1. プロパティインデックスのインデックス定義のCRXDE Liteから次のプロパティを設定し、非同期インデックス作成を有効にします — /oak:index/property index

   reindex=true

   reindex-async=true
2. 上記の更新ノードを検証するには、 async=&quot;async-reindex&quot;を設定する必要があります。
3. PropertyIndexAsyncReindex MBean で startPropertyIndexAsyncReindex を呼び出します。 これにより、バックグラウンドジョブが開始され、そのようなタイプのインデックスが検索されます。 呼び出し後に、ログ行「インデックスの再作成が実行されます…
4. 再インデックスが完了すると、再インデックスフラグが false にリセットされます。
5. 手順 3 を再度呼び出して、インデックスを同期インデックスに戻します。 async フラグが削除されない場合、Mbean は複数回呼び出される必要がある場合があります（これは、このインデックスに同時に変更が発生する場合に発生します）。



*注意：* インデックス作成が実行されるスレッドを制御する「async=&quot;async-reindex&quot;」のみが削除されます。  「reindex-async」プロパティは、自動的には変更されない設定フラグです。 このアイデアは、今後のすべてのインデックス再作成を制御する特定のインデックス定義に対して 1 回設定するというものです。 そうすれば、その中に留まって、二度と触れる必要がなくなると予想されます。


<b>手順 2:</b> インデックス再作成チェックポイントを削除します (AEM 6.2 以前のバージョンのみ )。

非同期インデックス再作成のプロセス中に、リポジトリチェックポイントが作成されます。 インデックス作成タスクが完了したら、後でリビジョンのガベージコレクションをスムーズにするために、以下の説明に従ってリリースする必要があります。

1. まず、CheckpointManager MBean を開きます。

   MongoMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3Document+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. listCheckpoints() 操作を呼び出します。
3. 「name=async-reindex」プロパティでチェックポイント行を見つけます。
4. ID 値をクリップボードにコピーします。

   MongoMK では、次のようになります。r1234567aaa-0-1

   TarMK では、次のようになります。 6eac07d0-fe27-4d16-82f8-6d5da4cefd67
5. 次に、 releaseCheckpoint() 操作を開きます。
6. コピーした ID を p1 として貼り付け、「呼び出し」をクリックします。
7. この手順により、チェックポイントが解放されます。
