---
title: 「同期 AEM インデックスの再インデックス化方法 | AEM、Oak」
description: 「インデックスをバックグラウンドスレッドに送信して、同期AEMインデックスを再インデックスする方法を説明します。」
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS，方法， Adobe Experience Manager，インデックス再作成，同期AEMインデックス， Oak"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Nayanika Chakravarty
article-created-date: "4/8/2024 4:58:39 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "4/8/2024 5:19:14 PM"
version-number: 4
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=d4db733c-c9f5-ee11-a1fe-6045bd006295"
source-git-commit: 8bbccca8bda86fcc36d081c9532db2231de173b5
workflow-type: tm+mt
source-wordcount: '436'
ht-degree: 22%

---

# 同期 AEM インデックスの再インデックス化方法 | AEM、Oak


同期AEMインデックスを再インデックスするには、reindex プロパティをに設定します。 <b>*true</b>*. ただし、この場合、Oak インスタンスがハングし、インデックス作成をバックグラウンドスレッドに送信する必要が生じる可能性があります。 この記事では、その方法を説明します。

## 説明 {#description}


### 環境

Adobe Experience Manager

### 問題

ダウンタイムを発生させずに、同期 Oak インデックスを適切に再インデックス化する方法を教えてください。


## 解決策 {#resolution}


reindex プロパティをに設定するだけで、同期インデックスのインデックスを再作成します。 *true* 同期操作を行うと、Oak インスタンスがハングする可能性があります。

この状況を回避するには、インデックス作成をバックグラウンドスレッドに送信します。 次の手順に従います。

<b><u>手順 1：バックグラウンドスレッドで再インデックスを作成する</u></b>

1. 次のプロパティを次の場所から設定します。 <b>CRXDE Lite</b> 非同期インデックス作成を有効にするプロパティインデックスのインデックス定義で、次の操作を実行します。<br>


   ```
   /oak:index/<property index>
   reindex=true
   reindex-async=true
   ```


2. 上記でノードが更新されることを検証するために、`async="async-reindex"` を設定する必要があります。
3. を呼び出す `startPropertyIndexAsyncReindex` の `PropertyIndexAsyncReindex` MBean。<br>


   これにより、バックグラウンドジョブが開始され、そのようなタイプのインデックスが検索されます。



   呼び出し後に、ログ行のインデックス再作成が実行されます…
4. インデックスの再作成が完了すると、再インデックスフラグがにリセットされます。 *false*.
5. 手順 3 をもう一度呼び出して、インデックスを同期インデックスに戻します。async フラグが削除されない場合、Mbean は複数回呼び出される必要がある場合があります（これは、このインデックスに同時に変更が発生する場合に発生します）。



   <b>注意：</b> 次の項目のみ `async="async-reindex"` インデックス作成を実行するスレッドを制御する際に、が削除されます。

   The `reindex-async` プロパティは、単なる設定フラグで、自動的には変更されません。

   このアイデアは、今後のすべてのインデックス再作成を制御する特定のインデックス定義に対して 1 回設定するというものです。

   そうすれば、そこに留まり、二度と触る必要がなくなることが期待されます。


<b><u>手順 2：再インデックス化チェックポイントを削除する (AEM 6.2 以前のバージョンのみ )</u></b>

非同期インデックス再作成のプロセス中に、リポジトリチェックポイントが作成されます。
インデックス作成タスクが完了したら、後でリビジョンのガベージコレクションをスムーズにするために、以下の説明に従ってリリースする必要があります。

1. まず、を開きます。 <b>CheckpointManager</b> MBean:<br>\
   MongoMK の場合 — [`/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger`](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK の場合 — [`/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger`](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. を呼び出す `listCheckpoints()` 操作。
3. `name=async-reindex` プロパティでチェックポイント行を検索します。
4. ID 値をクリップボードにコピーします。<br>\
   MongoMK では、次のようになります。 `r1234567aaaa-0-1`

   TarMK では、次のようになります。 `6eac07d0-fe27-4d16-82f8-6d5da4cefd67`
5. 次に、`releaseCheckpoint()` 操作を開きます。
6. コピーした ID を p1 として貼り付け、 <b>起動</b>.
7. この手順によって、チェックポイントを解放します。

